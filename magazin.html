<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Magazine Layout</title>
  <style>
    :root {
      --theme-border: #ccc;
      --primary-color: #333;
      --bg-color: #fff;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: var(--primary-color);
      background: var(--bg-color);
      overflow-x: hidden;
    }

    /* Magazine Container */
    .magazine-container {
      height: 75vh;
      position: relative;
      overflow: hidden;
      margin: 2rem auto;
      max-width: 1400px;
    }

    /* Pages Wrapper - slides horizontally */
    .pages-wrapper {
      display: flex;
      height: 100%;
      transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      will-change: transform;
    }

    /* Multi-Column Page */
    .multi-column {
      min-width: 100%;
      height: 100%;
      padding: 2rem;
      column-gap: 30px;
      column-rule: 1px solid var(--theme-border);
      overflow: hidden;
    }

    /* Responsive Column Count */
    @media (min-width: 1024px) {
      .multi-column {
        column-count: 3;
      }
    }

    @media (min-width: 768px) and (max-width: 1023px) {
      .multi-column {
        column-count: 2;
      }
    }

    @media (max-width: 767px) {
      .multi-column {
        column-count: 1;
      }
    }

    /* List Styling */
    ol {
      list-style: none;
    }

    ol li {
      margin-bottom: 2rem;
    }

    ol li .number::before {
      content: attr(data-number);
      display: block;
      font-size: 150%;
      font-weight: bold;
      margin-bottom: 0.5rem;
    }

    ol li img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 0.5rem 0;
    }

    /* Hochformat Bilder */
    ol li img[data-orientation="portrait"] {
      max-width: 300px;
      max-height: 300px;
    }

    /* Navigation */
    .magazine-nav {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2rem;
      margin: 2rem auto;
      max-width: 1400px;
      padding: 0 2rem;
    }

    .magazine-nav button {
      background: var(--primary-color);
      color: var(--bg-color);
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      transition: transform 0.2s, opacity 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .magazine-nav button:hover:not(:disabled) {
      transform: scale(1.1);
    }

    .magazine-nav button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .magazine-nav button:active:not(:disabled) {
      transform: scale(0.95);
    }

    /* Pagination Dots */
    .pagination-dots {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      max-width: 300px;
      justify-content: center;
    }

    .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #ddd;
      transition: all 0.3s;
      cursor: pointer;
    }

    .dot.active {
      background: var(--primary-color);
      transform: scale(1.3);
    }

    .dot:hover {
      background: #999;
    }

    /* Lazy Loading */
    img[data-lazy] {
      opacity: 0;
      transition: opacity 0.3s;
    }

    img[data-lazy].loaded {
      opacity: 1;
    }

    /* Hidden source content */
    .content-source {
      display: none;
    }
  </style>
</head>
<body>

  <!-- Original Content (wird von JS gelesen und reorganisiert) -->
  <div class="content-source">
    <ol data-items="3,2,1">
      <li>
        <br>
        <img src="https://placecats.com/millie/300/150" alt="Projekt 1">
        <br>
        <span class="number"></span>
        Photoshop<br>
        Browser<br>
        Logo<br><br>
        Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.<br>
      </li>
      <li>
        <br>
        <img src="https://placecats.com/millie/300/150" alt="Projekt 2">
        <br>
        <span class="number"></span>
        Illustrator<br>
        Mobile App<br>
        Branding<br><br>
        Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur.<br>
      </li>
      <li>
        <br>
        <img src="https://placecats.com/millie/150/300" data-orientation="portrait" alt="Projekt 3">
        <br>
        <span class="number"></span>
        Figma<br>
        Web Design<br>
        UI/UX<br><br>
        Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem.<br>
      </li>
    </ol>

    <ol data-items="3,2,2">
      <li>
        <br>
        <img src="https://placecats.com/millie/300/150" alt="Projekt 4">
        <br>
        <span class="number"></span>
        After Effects<br>
        Motion Graphics<br>
        Animation<br><br>
        Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur. Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse.<br>
      </li>
      <li>
        <br>
        <img src="https://placecats.com/millie/300/150" alt="Projekt 5">
        <br>
        <span class="number"></span>
        Sketch<br>
        Product Design<br>
        Prototyping<br><br>
        Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur.<br>
      </li>
      <li>
        <br>
        <img src="https://placecats.com/millie/150/300" data-orientation="portrait" alt="Projekt 6">
        <br>
        <span class="number"></span>
        InDesign<br>
        Editorial<br>
        Layout<br><br>
        At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi.<br>
      </li>
    </ol>

    <ol data-items="3,2,1">
      <li>
        <br>
        <img src="https://placecats.com/millie/300/150" alt="Projekt 7">
        <br>
        <span class="number"></span>
        XD<br>
        Interaction Design<br>
        Wireframing<br><br>
        Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor repellendus.<br>
      </li>
      <li>
        <br>
        <img src="https://placecats.com/millie/300/150" alt="Projekt 8">
        <br>
        <span class="number"></span>
        Premiere Pro<br>
        Video Editing<br>
        Post Production<br><br>
        Omnis voluptas assumenda est, omnis dolor repellendus. Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint.<br>
      </li>
      <li>
        <br>
        <img src="https://placecats.com/millie/150/300" data-orientation="portrait" alt="Projekt 9">
        <br>
        <span class="number"></span>
        Blender<br>
        3D Modeling<br>
        Rendering<br><br>
        Itaque earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat.<br>
      </li>
    </ol>

    <ol data-items="3,2,2" data-lazy="true">
      <li>
        <br>
        <img data-lazy="https://placecats.com/millie/300/150" alt="Projekt 10">
        <br>
        <span class="number"></span>
        Cinema 4D<br>
        Visual Effects<br>
        CGI<br><br>
        Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis.<br>
      </li>
      <li>
        <br>
        <img data-lazy="https://placecats.com/millie/300/150" alt="Projekt 11">
        <br>
        <span class="number"></span>
        Unity<br>
        Game Design<br>
        Interactive<br><br>
        Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.<br>
      </li>
      <li>
        <br>
        <img data-lazy="https://placecats.com/millie/300/150" alt="Projekt 12">
        <br>
        <span class="number"></span>
        Substance Painter<br>
        Texturing<br>
        Materials<br><br>
        Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore.<br>
      </li>
    </ol>
  </div>

  <!-- Dynamisch generierte Pages -->
  <div class="magazine-container">
    <div class="pages-wrapper">
      <!-- Wird von JS gefüllt -->
    </div>
  </div>

  <nav class="magazine-nav">
    <button class="prev" aria-label="Vorherige Seite">←</button>
    <div class="pagination-dots"></div>
    <button class="next" aria-label="Nächste Seite">→</button>
  </nav>

  <script>
    class MagazineLayout {
      constructor() {
        this.container = document.querySelector('.magazine-container');
        this.wrapper = document.querySelector('.pages-wrapper');
        this.prevBtn = document.querySelector('.prev');
        this.nextBtn = document.querySelector('.next');
        this.dotsContainer = document.querySelector('.pagination-dots');
        this.contentSource = document.querySelector('.content-source');
        
        this.currentPage = 0;
        this.totalPages = 0;
        this.touchStartX = 0;
        this.touchEndX = 0;
        this.resizeTimeout = null;
        
        this.init();
      }

      init() {
        this.buildPages();
        this.attachEventListeners();
        this.updateNavigation();
        this.loadVisibleImages();
      }

      // Ermittelt aktuellen Breakpoint
      getCurrentBreakpoint() {
        const width = window.innerWidth;
        if (width >= 1024) return 0; // Desktop
        if (width >= 768) return 1;  // Tablet
        return 2; // Mobile
      }

      // Baut Pages basierend auf data-items Hints
      buildPages() {
        // Clear existing pages
        this.wrapper.innerHTML = '';
        
        const breakpointIndex = this.getCurrentBreakpoint();
        const sourceGroups = this.contentSource.querySelectorAll('ol[data-items]');
        let globalCounter = 1;
        
        sourceGroups.forEach((sourceOl, groupIndex) => {
          const itemsConfig = sourceOl.dataset.items.split(',').map(n => parseInt(n.trim()));
          const itemsPerPage = itemsConfig[breakpointIndex] || itemsConfig[0];
          const isLazy = sourceOl.dataset.lazy === 'true';
          
          const allItems = Array.from(sourceOl.querySelectorAll('li'));
          
          // Teile Items in Seiten auf
          for (let i = 0; i < allItems.length; i += itemsPerPage) {
            const pageItems = allItems.slice(i, i + itemsPerPage);
            
            // Erstelle neue Page
            const page = document.createElement('div');
            page.classList.add('multi-column');
            
            const ol = document.createElement('ol');
            
            pageItems.forEach(item => {
              const clonedItem = item.cloneNode(true);
              
              // Setze Nummerierung
              const numberSpan = clonedItem.querySelector('.number');
              if (numberSpan) {
                const formattedNumber = String(globalCounter).padStart(2, '0');
                numberSpan.setAttribute('data-number', formattedNumber);
                globalCounter++;
              }
              
              ol.appendChild(clonedItem);
            });
            
            page.appendChild(ol);
            this.wrapper.appendChild(page);
          }
        });
        
        this.pages = document.querySelectorAll('.multi-column');
        this.totalPages = this.pages.length;
        
        // Reset current page wenn nötig
        if (this.currentPage >= this.totalPages) {
          this.currentPage = Math.max(0, this.totalPages - 1);
        }
        
        this.createPaginationDots();
      }

      createPaginationDots() {
        this.dotsContainer.innerHTML = '';
        
        for (let i = 0; i < this.totalPages; i++) {
          const dot = document.createElement('div');
          dot.classList.add('dot');
          if (i === this.currentPage) dot.classList.add('active');
          dot.addEventListener('click', () => this.goToPage(i));
          this.dotsContainer.appendChild(dot);
        }
      }

      attachEventListeners() {
        // Button Navigation
        this.prevBtn.addEventListener('click', () => this.prevPage());
        this.nextBtn.addEventListener('click', () => this.nextPage());

        // Keyboard Navigation
        document.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowLeft') this.prevPage();
          if (e.key === 'ArrowRight') this.nextPage();
        });

        // Touch/Swipe Navigation
        this.container.addEventListener('touchstart', (e) => {
          this.touchStartX = e.changedTouches[0].screenX;
        });

        this.container.addEventListener('touchend', (e) => {
          this.touchEndX = e.changedTouches[0].screenX;
          this.handleSwipe();
        });

        // Mouse Drag
        let isDragging = false;
        let startX = 0;

        this.container.addEventListener('mousedown', (e) => {
          isDragging = true;
          startX = e.clientX;
          this.container.style.cursor = 'grabbing';
        });

        document.addEventListener('mousemove', (e) => {
          if (!isDragging) return;
          e.preventDefault();
        });

        document.addEventListener('mouseup', (e) => {
          if (!isDragging) return;
          isDragging = false;
          this.container.style.cursor = 'grab';
          
          const endX = e.clientX;
          const diff = startX - endX;
          
          if (Math.abs(diff) > 50) {
            if (diff > 0) this.nextPage();
            else this.prevPage();
          }
        });

        // Resize Handler mit Debouncing
        window.addEventListener('resize', () => {
          clearTimeout(this.resizeTimeout);
          this.resizeTimeout = setTimeout(() => {
            this.handleResize();
          }, 250);
        });
      }

      handleResize() {
        // Rebuild pages für neuen Breakpoint
        this.buildPages();
        this.updatePage();
        this.loadVisibleImages();
      }

      handleSwipe() {
        const swipeThreshold = 50;
        const diff = this.touchStartX - this.touchEndX;

        if (Math.abs(diff) > swipeThreshold) {
          if (diff > 0) this.nextPage();
          else this.prevPage();
        }
      }

      nextPage() {
        if (this.currentPage < this.totalPages - 1) {
          this.currentPage++;
          this.updatePage();
        }
      }

      prevPage() {
        if (this.currentPage > 0) {
          this.currentPage--;
          this.updatePage();
        }
      }

      goToPage(index) {
        this.currentPage = index;
        this.updatePage();
      }

      updatePage() {
        const offset = -this.currentPage * 100;
        this.wrapper.style.transform = `translateX(${offset}%)`;
        this.updateNavigation();
        this.loadVisibleImages();
      }

      updateNavigation() {
        // Update buttons
        this.prevBtn.disabled = this.currentPage === 0;
        this.nextBtn.disabled = this.currentPage === this.totalPages - 1;

        // Update dots
        const dots = this.dotsContainer.querySelectorAll('.dot');
        dots.forEach((dot, index) => {
          dot.classList.toggle('active', index === this.currentPage);
        });
      }

      loadVisibleImages() {
        // Load images for current page and adjacent pages
        const pagesToLoad = [
          this.currentPage - 1,
          this.currentPage,
          this.currentPage + 1
        ].filter(i => i >= 0 && i < this.totalPages);

        pagesToLoad.forEach(pageIndex => {
          const page = this.pages[pageIndex];
          const lazyImages = page.querySelectorAll('img[data-lazy]');
          
          lazyImages.forEach(img => {
            if (!img.src || img.src === window.location.href) {
              img.src = img.dataset.lazy;
              img.classList.add('loaded');
              img.removeAttribute('data-lazy');
            }
          });
        });
      }
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => new MagazineLayout());
    } else {
      new MagazineLayout();
    }
  </script>

</body>
</html>